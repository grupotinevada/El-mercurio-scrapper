<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Extractor de Remates</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="text-light d-flex align-items-center justify-content-center min-vh-100" style="background-color: #d4d4d4;">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-6 col-md-8">
        <div class="card bg shadow">
          <div class="card-body">
            <h3 class="card-title text-center mb-4">Extractor de Remates</h3>

            <div class="mb-3">
              <label for="url" class="form-label">URL del Mercurio</label>
              <input type="text" class="form-control" id="url" placeholder="URL El Mercurio" required>
            </div>

            <div class="mb-3">
              <label for="paginas" class="form-label">Páginas a procesar</label>
              <input type="number" class="form-control" id="paginas" placeholder="Número de páginas" required>
            </div>

            <div class="mb-3">
              <label for="usuario" class="form-label">Usuario</label>
              <input type="text" class="form-control" id="usuario" value="barbara@grupohouse.cl" required>
            </div>

            <div class="mb-3">
              <label for="password" class="form-label">Contraseña</label>
              <input type="password" class="form-control" id="password" value="Fliphouse" required>
            </div>

            <div class="d-grid">
              <button class="btn btn-outline-primary fw-bold" id="submitBtn" onclick="enviar()">Procesar</button>
            </div>

            <p id="status" class="mt-3 text-center fw-bold"></p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    async function enviar() {
      const submitButton = document.getElementById('submitBtn');
      const statusElement = document.getElementById('status');

      const data = {
        url: document.getElementById('url').value,
        paginas: document.getElementById('paginas').value,
        usuario: document.getElementById('usuario').value,
        password: document.getElementById('password').value
      };

      submitButton.disabled = true;
      statusElement.textContent = 'Iniciando proceso...';
      statusElement.className = 'mt-3 text-center fw-bold text-light';

      try {
        const response = await window.pywebview.api.procesar_formulario(data);
        statusElement.textContent = response.message;
        statusElement.className = response.success ? 'mt-3 text-center fw-bold text-success' : 'mt-3 text-center fw-bold text-danger';
      } catch (e) {
        statusElement.textContent = 'Error de comunicación con el backend.';
        statusElement.className = 'mt-3 text-center fw-bold text-danger';
        console.error(e);
      } finally {
        submitButton.disabled = false;
      }
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
